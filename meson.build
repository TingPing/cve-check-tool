project('cve-check-tool', 'c',
    version: '5.6.4',
    meson_version: '>= 0.47.0',
    default_options: [
        'c_std=gnu11',
        'warning_level=2',
    ]
)

cc = meson.get_compiler('c')

gio_dep = dependency('gio-2.0', version: '>= 2.36.0')
dl_dep = cc.find_library('dl')
libxml_dep = dependency('libxml-2.0', version: '>= 2.9.1')
curl_dep = dependency('libcurl', version: '>= 7.29.0')
openssl_dep = dependency('openssl', version: '>= 1.0.0')
sqlite_dep = dependency('sqlite3')
check_dep = dependency('check', version: '>= 0.9', required: false)

pkgdatadir = join_paths(get_option('datadir'), 'cve-check-tool')
pkglibdir = join_paths(get_option('libdir'), 'cve-check-tool')

config = configuration_data()
config.set_quoted('PACKAGE_NAME', meson.project_name())
config.set_quoted('PACKAGE', meson.project_name())
config.set_quoted('PACKAGE_VERSION', meson.project_version())
config.set_quoted('MODULE_DIR', pkglibdir)
config.set_quoted('DATA_DIRECTORY', pkgdatadir)

configure_file(
    configuration: config,
    output: 'config.h'
)

add_project_arguments(
    '-I' + meson.current_build_dir(),
    language: 'c'
)

subdir('data')
subdir('docs')
subdir('src')
# subdir('tests')